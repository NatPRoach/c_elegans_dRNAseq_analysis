#!/usr/bin/env bash

.././modelUTRs_v2.py ../results/realigned_isoforms/all_isoforms.tsv ../results/realigned_utrs/beds/all_isoforms_utrs.bed ../results/realigned_utrs/assignments/all_isoforms_utrs.tsv

.././split_realigned_UTRs.py

./modify_bed_for_3prime_fasta_extraction.py ../results/realigned_utrs/beds/all_isoforms_utrs.bed expanded.bed

bedtools getfasta -name -s -fi ../../00_Data/references/ce11/ce11.fa -bed expanded.bed -fo expanded.fa

./trim_fasta.py expanded.fa trimmed.fa

#grep ">" trimmed.fa | wc -l
#grep "AATAAA" trimmed.fa | wc -l

#./plotCanonicalPAS.py trimmed.fa
./plotAllPAS.py trimmed.fa bartelAltPAS.txt pasAssignmentFile.tsv

./compare_polyA_vs_PAS.py